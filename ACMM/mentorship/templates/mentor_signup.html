{% extends 'base.html' %} {% load crispy_forms_tags %} {% block content %}
<div class ="mb-2 bg-white text-dark rounded">
   <div class="p-3 bg-secondary text-white rounded-top">
      <h1>Mentor Sign-Up </h1>
      <p>
         Thank you for your willingness to sign up as a mentor and support a student through their medical school application! 
         You will receive training and resources to equip you in your role, an opportunity to become the 'mentor of the year' and a certificate for your portfolio.
         As well as this, you will have the opportunity to guide a prospective medical student through their application process which is highly rewarding. 
         <br/>
         Applications are open from 1st April - 30th April 2021. 
         <br/>
         This commitment is for one year.
         <br/>
         If you require more information, please see our <strong><a href="www.acmedicalmentors.co.uk/mentoring" class="text-white"> website</a>:</strong>
      </p>
   </div>
   <form id="profile-form" method="post">
      {% csrf_token %}
      <div class=" p-3">
         <h4>Personal Information</h4>
         <div class="form-row">
            <div class="form-group col-md-6 mb-0">
               {{ form.first_name|as_crispy_field }}
            </div>
            <div class="form-group col-md-6 mb-0">
               {{ form.last_name|as_crispy_field }}
            </div>
         </div>
         
         <div class="form-row">
            <div class="form-group col-md-10 mb-0">
               {{ form.email|as_crispy_field }}
            </div>
            <div class="form-group col-md-2 mb-0">
               {{ form.sex|as_crispy_field }}
            </div>
         </div>
        
         <hr class="my-4">
         
         <h4>Background Information</h4>
         <div class="form-row">
            <div class="form-group col-md-6 mb-0">
               {{ form.occupation|as_crispy_field }}
            </div>
            <div class="form-group col-md-6 mb-0">
               {{ form.year_applied|as_crispy_field }}
            </div>
         </div>
         <div class="form-row">
            <div class="form-group col-md-4 mb-0">
               {{ form.area_of_support|as_crispy_field }}
            </div>
            <div class="form-group col-md-4 mb-0">
               {{ form.entrance_exam_experience|as_crispy_field }}
            </div>
            <div class="form-group col-md-4 mb-0">
               {{ form.interview_experience|as_crispy_field }}
            </div>
         </div>
      </div>
      
      <div id="qualification-container">
         <h5 class="p-3">Qualification(s)</h5>
         {{qualification_formset.management_form |crispy}}
         {% for form in qualification_formset %}
         <div class="form-row qualification-form p-3">
            <div class="form-group col-md-6 mb-0">
               {{ form.name|as_crispy_field }}
            </div>
            <div class="form-group col-md-6 mb-0">
               {{ form.education_level|as_crispy_field }}
            </div>
            <button class="align-self-center btn btn-outline-danger btn-xs delete-qualification-form" type="button">Delete</button>
         </div>
         {% endfor %}
      </div>
      <div class="form-row p-3">
         <button id="add-qualification-form"  class="align-middle btn btn-outline-secondary" type="button">Add Another Qualification</button>
      </div>
      <div class="form-row p-3">
         {{ form.hear_about_us|as_crispy_field }}
     </div>
     <div class="form-row p-3">
         <button type="submit" class="btn btn-secondary btn-lg">Join Us !</button>    
      </div>

    </form>
</div>
<script>
   const mainForm = document.querySelector("#profile-form");
   const qualificationForm = document.getElementsByClassName("qualification-form");
   const addButton = document.querySelector("#add-qualification-form");
   const qualificationContainer = document.querySelector("#qualification-container");
   let qualificationFormCount = qualificationForm.length - 1;
   const totalForms = document.querySelector("#id_mentorqualification_set-TOTAL_FORMS");
   function updateForms() {
     let count = 0;
     for (let form of qualificationForm) {
         const formRegex = RegExp(`form-(\\d){1}-`, 'g');
         form.innerHTML = form.innerHTML.replace(formRegex, `form-${count++}-`)
     }
   }
   addButton.addEventListener('click', function(e){
           e.preventDefault();
           console.log('Hey')
           let newQualificationForm = qualificationForm[0].cloneNode(true);
           console.log(qualificationFormCount)
           console.log('Hey')
           let formRegex = RegExp(`form-(\\d){1}-`,'g')
           qualificationFormCount++
           console.log(qualificationFormCount)
           newQualificationForm.innerHTML = newQualificationForm.innerHTML.replace(formRegex, `form-${qualificationFormCount}-`);
           qualificationContainer.append(newQualificationForm);
           totalForms.setAttribute('value', `${qualificationFormCount+1}`)
       });
   mainForm.addEventListener('click',function(event){
       if (event.target.classList.contains("delete-qualification-form")) {
           event.preventDefault();
           event.target.parentElement.remove();
           qualificationFormCount--;
           updateForms();
           totalForms.setAttribute('value', `${qualificationFormCount+1}`);
   }
       
   });
</script>
{% endblock %}
